<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<input type="text" />
<button id="send">send</button>
<button id="close">close</button>

<script>
    let lastText;
    const sendButton = document.querySelector('#send');
    const closeButton = document.querySelector('#close');
    const input = document.querySelector('input');

    const ws = new WebSocket('ws://localhost:8000/echo');
    ws.onopen = (e) => console.log('open', e);
    ws.onclose = (e) => console.log('close', e);
    ws.onerror = (e) => console.error('close', e);
    ws.onmessage = (e) => {
      console.log('message', e.data.length, lastText.length, e.data === lastText, e);
    };

    sendButton.addEventListener('click', () => {
        ws.send(lastText = input.value);
    });

    closeButton.addEventListener('click', () => {
        ws.close();
    });

</script>
</body>
</html>
